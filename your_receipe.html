<!DOCTYPE html>
<html lang="ru">
<head>
  <!-- Базовые настройки страницы -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ваш рецепт</title>
  <!-- Подключение шрифта Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
  <!-- Подключение CSS-файла -->
  <link rel="stylesheet" href="styles_your_receipe.css">
   <!-- Подключение базы данных -->
  <script src="https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.6.0/firebase-analytics.js"></script>
</head>
<body>
  <!-- Шапка сайта с логотипом и навигацией -->
  <header>
    <div class="logo-title">
      <!-- Логотип сайта -->
      <img src="logo.png" alt="Логотип" class="logo">
      <!-- Заголовок страницы -->
      <h1>Ваш рецепт</h1>
    </div>
    <!-- Чекбокс для мобильного меню (гамбургер) -->
    <input type="checkbox" id="menu-toggle">
    <!-- Иконка мобильного меню (гамбургер) -->
    <label class="menu-icon" for="menu-toggle">
      <span></span>
      <span></span>
      <span></span>
    </label>

    <!-- Основное меню навигации -->
    <div class="menu">
      <a href="index.html">Главная</a> 
      <a href="receipes2.html">Рецепты</a> 
    </div>
  </header>

  <!-- Основной контейнер с формой добавления рецепта -->
  <div class="container">
    <!-- Форма для добавления нового рецепта -->
    <form id="recipeForm">
      <!-- Поле для названия рецепта -->
      <div>
        <label for="title">Название рецепта</label>
        <input type="text" id="title" name="title" placeholder="Введите название" required>
      </div>
      <!-- Поле для краткого описания -->
      <div>
        <label for="description">Краткое описание</label>
        <input type="text" id="description" name="description" placeholder="Введите описание" required>
      </div>
      <!-- Поле для списка ингредиентов -->
      <div>
        <label for="ingredients">Состав</label>
        <textarea id="ingredients" name="ingredients" placeholder="Введите ингредиенты" required></textarea>
      </div>
      <!-- Блок для загрузки изображения -->
      <div class="upload-block">
        <label for="photo" class="upload-button">Загрузите фото</label>
        <input type="file" id="photo" name="photo" accept="image/*">
        <!-- Превью загруженного изображения -->
        <img id="preview" class="preview-image" alt="Предпросмотр изображения">
      </div>
      <!-- Кнопка отправки формы -->
      <button type="submit" class="button">Добавить</button>
    </form>
  </div>

  <!-- Подвал сайта -->
  <div class="footer">
    <!-- Левая часть подвала с контактами -->
    <div class="left">
      <p>Контакты<br>тел.: 895398700**<br>email: lizashe2005@mail.ru</p>
    </div>
    <!-- Правая часть подвала с копирайтом -->
    <div>
      <p>© 2025 Кулинарная книга.<br>Все права защищены.</p>
    </div>
  </div>
  
  <script>
  const firebaseConfig = {
    apiKey: "AIzaSyBv87aexiTY_jIipKV986xQH1pmcyfg9rY",
    authDomain: "cookreceipe-84401.firebaseapp.com",
    databaseURL: "https://cookreceipe-84401-default-rtdb.firebaseio.com",
    projectId: "cookreceipe-84401",
    storageBucket: "cookreceipe-84401.firebasestorage.app",
    messagingSenderId: "737772447460",
    appId: "1:737772447460:web:b91a1d80e68b2705642ef1",
    measurementId: "G-GX6QX3YQ67"
  };
 firebase.initializeApp(firebaseConfig);
    
// Превью фото
    document.getElementById('photo').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          document.getElementById('preview').src = e.target.result;
          document.getElementById('preview').style.display = 'block';
        }
        reader.readAsDataURL(file);
      }
    });

    // Отправка формы
    document.getElementById('recipeForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const title = document.getElementById('title').value;
      const description = document.getElementById('description').value;
      const ingredients = document.getElementById('ingredients').value;
      const photoFile = document.getElementById('photo').files[0];

      if (!photoFile) {
        alert("Пожалуйста, загрузите фото рецепта!");
        return;
      }

      try {
        // Загрузка фото в Storage
        const storageRef = firebase.storage().ref();
        const photoRef = storageRef.child('recipe_photos/' + Date.now() + '_' + photoFile.name);
        await photoRef.put(photoFile);
        const photoUrl = await photoRef.getDownloadURL();

        // Сохранение рецепта в Database
        await firebase.database().ref('recipes/').push({
          title,
          description,
          ingredients,
          imageUrl: photoUrl,
          createdAt: firebase.database.ServerValue.TIMESTAMP
        });

        alert("Рецепт успешно добавлен!");
        document.getElementById('recipeForm').reset();
        document.getElementById('preview').style.display = 'none';
      } catch (error) {
        console.error("Ошибка:", error);
        alert("Ошибка при добавлении рецепта: " + error.message);
      }
    });
  </script>
</body>
</html>
